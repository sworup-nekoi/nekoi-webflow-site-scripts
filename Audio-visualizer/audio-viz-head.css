
/* =============================================
   Audio Visualizer – HEAD CSS (external file)
   Load this via a <link> tag or @import.
   The JS reads these CSS Custom Properties live
   so theme swaps and responsive clamps just work.
   ============================================= */

/* Wrapper keeps Webflow size/position; canvas just fills it */
.audio-visualizer { position: relative; overflow: hidden; }
.audio-visualizer canvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  display: block;
  pointer-events: none;
}

/* Themeable tokens — scope on html+body so they follow your theme mode */
html, body {
  /* BAR COLORS (A/B alternating) */
  --viz-bar:      var(--_theme---text-main);
  --viz-bar-alt:  var(--_theme---accent);       /* set equal to --viz-bar to disable alternation */

  /* Cap color (small floating block) */
  --viz-cap:      var(--_theme---text-main);

  /* Layout */
  --viz-gap:      2px;                          /* gap between bars */
  --viz-pad-x:    0px;                          /* left/right padding inside the visualizer */
  --viz-min-bar:  8px;                          /* target px per bar */
  --viz-max-bars: 64;                           /* hard cap */

  /* Idle look when audio is paused/quiet */
  --viz-idle-px:        clamp(1px, 0.35vmin, 3px);  /* uniform bar height on silence */
  --viz-silence-thresh: 0.02;                       /* 0..1 raw energy below this = “silent” */

  /* Cap spacing & size (fluid) */
  --viz-cap-gap:  clamp(0.5px, 0.4vmin, 3px);
  --viz-cap-h:    clamp(0.5px, 0.2vmin, 2px);
  --viz-cap-drop: 0.6;                         /* lower is floatier */

  /* Behaviour */
  --viz-band-curve: 1.6;                        /* >1 = more low-end; 1 = linear */
  --viz-alt-every:  2;                          /* 2 = alternate every other bar; 999 = no alternation */
  --viz-agc:        1;                          /* gentle auto-gain on/off */
  --viz-agc-smooth: 0.10;                       /* 0.05..0.2 feels nice */

  /* Responsiveness on quiet content */
  --viz-sensitivity:     1.35;                  /* multiplies raw spectrum energy */
  --viz-smoothing:       0.60;                  /* analyser smoothing: 0 twitchy..0.98 sluggish */
  --viz-agc-max:         16;                    /* hard cap for auto-gain */
  --viz-min-active-frac: 0.40;                  /* at least 40% of bars show a minimum motion */
  --viz-min-active-px:   clamp(1px, 0.50vmin, 4px); /* minimum visible height for chosen bars */
  --viz-quiet-boost:     1.45;                  /* extra kick only on very quiet frames */
}

/* Mobile tuning: show more motion with fewer bars */
@media (max-width: 767px) {
  html, body {
    --viz-min-bar:       6px;                   /* allows more bars to fit */
    --viz-sensitivity:   5.0;                   /* stronger response */
    --viz-quiet-boost:   6.9;                   /* extra kick on very quiet frames */
    --viz-smoothing:     0.20;                  /* a bit snappier */
    --viz-band-curve:    2.0;                   /* emphasize low-end */
    --viz-agc-max:       24;                    /* let auto-gain push harder */
    --viz-agc-smooth:    0.12;                  /* slightly quicker AGC */
    --viz-min-active-frac: 0.66;                /* with ~3 bars → ~2 will move */
    --viz-min-active-px:   clamp(2px, 0.9vmin, 6px); /* ensure visible motion */
  }
}